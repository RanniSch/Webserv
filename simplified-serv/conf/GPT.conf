# Example web server configuration file

# Define a list of accepted HTTP methods for the route.
location /api {
    allow GET POST;
    deny all;
}

# Define an HTTP redirection.
location /old-url {
    return 301 /new-url;
}

# Define a directory or a file from where the file should be searched.
# For example, if url /kapouet is rooted to /tmp/www, /kapouet/pouic/toto/pouet maps to /tmp/www/pouic/toto/pouet.
location /kapouet {
    root /tmp/www;
}

# Turn on or off directory listing.
location /directory-listing {
    autoindex on;
}

# Set a default file to answer if the request is a directory.
location / {
    index index.html;
}

# Execute CGI based on certain file extension (e.g., .php).
location ~ \.php$ {
    fastcgi_pass unix:/var/run/php/php7.0-fpm.sock;
    include fastcgi_params;
    fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
}

# Make it work with POST and GET methods.
location /api-endpoint {
    allow POST GET;
    deny all;
}

# Make the route able to accept uploaded files and configure where they should be saved.
# For handling uploaded files, additional server configuration is needed.
location /upload {
    client_max_body_size 10m; # Maximum upload size
    upload_store /tmp/uploads; # Directory to save uploaded files
    upload_pass /upload-handler; # URL to the upload handling script
    upload_set_form_field $upload_field_name.name "$upload_file_name";
    upload_set_form_field $upload_field_name.content_type "$upload_content_type";
    upload_set_form_field $upload_field_name.path "$upload_tmp_path";
    upload_aggregate_form_field "$upload_field_name.md5" "$upload_file_md5";
    upload_aggregate_form_field "$upload_field_name.size" "$upload_file_size";
}

# Define the path to the CGI script and execute it.
location /cgi-bin {
    fastcgi_pass unix:/var/run/cgi/cgi.sock;
    include fastcgi_params;
    fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
}

# Additional server-wide configurations can go here.

server {
    listen 80;
    server_name example.com;

    # Server-specific configurations can go here.

}
